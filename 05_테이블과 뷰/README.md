# 5.테이블과 뷰

## 5.1 테이블 만들기
- 테이블은 표 형태로 구성된 2차원 구조로, 행과 열로 구성되어 있다.
- CREATE TABLE 은 테이블을 생성하는 SQL로, 테이블 이름, 열 이름, 데이터 형식 등을 지정한다
- AUTO_INCREMENT 는 열에 입력될 값이 1부터 자동 증가하도록 설정한다.
- 열에 빈 값을 허용하지 않으려면 NOT NULL을 입력한다.
- 열을 기본 키로 지정하려면 PRIMARY KEY를 입력한다.
- 열을 외래 키로 지정하려면 FOREIGN KEY 예약어를 입력한다.

## 5.2 제약조건으로 테이블을 견고하게
- 테이블을 만들 때는 테이블의 구조에 필요한 제약조건을 설정해줘야 한다.
- 기본키, 외래키, 고유키, 체크 등이 있다.

### 제약조건의 기본 개념과 종류
- 제약조건은 데이터의 무결성을 지키기 위해 제한하는 조건이다.
- 데이터의 무결성이란 `데이터에 결함이 없음`이란 의미이다.
- PRIMARY KEY : 제약조건
- FOREIGN KEY : 제약조건
- UNIQUE : 제약조건
- CHECK : 제약조건
- DEFAULT : 정의
- NULL : 값 허용

### 기본 키 제약조건
- 기본 키에 입력되는 값은 중복될 수 없으며, NULL 값이 입력될 수 없다.
- 테이블은 기본 키를 1개만 가질 수 있다.
- 1.CREATE TABLE 에서 PRIMARY KEY 예약어를 입력한다.
- 2.제일 마지막 행에 PRIMARY KEY(...)를 입력한다.
- 3.ALTER TABLE에서 PRIMARY KEY(...)를 입력한다.

### 외래 키 제약조건
- 외래 키 제약조건은 두 테이블 사이의 관계를 연결해주고, 그 결과 데이터의 무결성을 보장 한다.
- 외래 키가 설정된 열은 꼭 다른 테이블의 기본 키와 연결된다.
- 참조 테이블이 참조하는 기준 테이블의 열은 반드시 기본키, 고유키 로 설정되어 있어야 한다.
- 1.CREATE TABLE에서 설정하는 외래 키 제약조건
```sql
FOREIGN KEY(mem_id) REFERENCES member(mem_id)
```
- 2.ALTER TABLE에서 설정하는 외래 키 제약조건
```sql
ALTER TABLE buy
  ADD CONSTRAINT
  FOREIGN KEY(mem_id)
  REFERENCES member(mem_id)
```
- 기본키-외래키 관계가 설정되면 기준 테이블의 열은 변경되거나 삭제되지 않는다.
- ON UPDATE CASCADE, ON DELETE CASCADE문을 사용하면 기준 테이블의 열 이름이 변경될 때 참조 테이블의 열 이름이 자동으로 변경된다.

### 기타 제약조건
- `고유 키` 제약조건은 중복되지 않는 유일한 값을 입력해야 하는 조건이다. 고유키 제약 조건은 NULL값을 허용한다.
- 고유키는 여러개를 설정해도 된다.
- `체크` 제약조건은 입력되는 데이터를 점검하는 기능을 한다. 
- `기본 값 정의` 는 값을 입력하지 않을 때 자동으로 입력될 값을 미리 지정해 놓는 방법이다.

## 5.3 가상의 테이블 뷰
- 뷰는 가상의 테이블이다.
- 뷰를 사용하면 사용자에게 테이블의 필요한 내용만 보이도록 할 수 있다.
- `단순 뷰`는 하나의 테이블과 연관된 뷰를 말하고, `복합 뷰`는 2개 이상의 테이블과 연관된 뷰를 말한다.

### 뷰의 개념
- 뷰의 실체는 SELECT 문이다.
```sql
CREATE VIEW 뷰_이름
AS
  SELECT 문;
```
- 뷰는 보안에 도움이 된다.
- 복잡한 SQL을 단순하게 만들 수 있다.

### 뷰의 실제 작동
- 뷰에서 사용될 열 이름을 별칭을 통해 바꿀 수 있다.
- 뷰의 수정은 ALTER VIEW 구문을, 뷰의 삭제는 DROP VIEW 구문을 사용한다.
- CREATE OR REPLACE VIEW 는 기존에 뷰가 있어도 덮어쓰는 효과를 가진다.
- DESCRIBE 문으로 기존 뷰의 정보를 확인할 수 있다.
- 복합 뷰는 읽기 전용이므로 뷰를 통해 테이블에 데이터를 입력/수정/삭제 할 수 없다.
- 뷰를 조회할 때는 열 이름에 공백이 있으면 백틱(`)으로 묶어줘야 한다.
